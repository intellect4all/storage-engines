<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520">
  <defs>
    <linearGradient id="crcGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1d4ed8;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="keyGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="valueGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="tombstoneGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ef4444;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#dc2626;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Title -->
  <text x="450" y="28" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="18" font-weight="600" fill="#1f2937">Append-Only Log: 5 Sequential Operations</text>
  <text x="450" y="48" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="12" fill="#6b7280">segment_001.seg</text>
  
  <!-- File container -->
  <rect x="30" y="60" width="840" height="400" rx="8" fill="#f9fafb" stroke="#e5e7eb" stroke-width="2"/>
  
  <!-- Offset markers on the left -->
  <text x="20" y="75" text-anchor="end" font-family="monospace" font-size="9" fill="#9ca3af">offset</text>
  
  <!-- Record 1: Put("alice", "100") -->
  <g transform="translate(40, 80)">
    <text x="0" y="-5" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#374151">Record 1: Put("alice", "100")</text>
    <text x="-30" y="30" text-anchor="end" font-family="monospace" font-size="9" fill="#6b7280">0</text>
    
    <rect x="0" y="10" width="50" height="40" rx="3" fill="url(#crcGrad)" stroke="#b45309" stroke-width="1"/>
    <text x="25" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">CRC32</text>
    <text x="25" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">0xA1B2</text>
    
    <rect x="52" y="10" width="70" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="87" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Timestamp</text>
    <text x="87" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">1703001000</text>
    
    <rect x="124" y="10" width="50" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="149" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">KeySz</text>
    <text x="149" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">5</text>
    
    <rect x="176" y="10" width="50" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="201" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">ValSz</text>
    <text x="201" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">3</text>
    
    <rect x="228" y="10" width="60" height="40" rx="3" fill="url(#keyGrad)" stroke="#6d28d9" stroke-width="1"/>
    <text x="258" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Key</text>
    <text x="258" y="40" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.9)">"alice"</text>
    
    <rect x="290" y="10" width="55" height="40" rx="3" fill="url(#valueGrad)" stroke="#047857" stroke-width="1"/>
    <text x="317" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Value</text>
    <text x="317" y="40" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.9)">"100"</text>
    
    <!-- Byte count -->
    <text x="360" y="35" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#6b7280">← 28 bytes</text>
  </g>
  
  <!-- Record 2: Put("bob", "250") -->
  <g transform="translate(40, 145)">
    <text x="0" y="-5" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#374151">Record 2: Put("bob", "250")</text>
    <text x="-30" y="30" text-anchor="end" font-family="monospace" font-size="9" fill="#6b7280">28</text>
    
    <rect x="0" y="10" width="50" height="40" rx="3" fill="url(#crcGrad)" stroke="#b45309" stroke-width="1"/>
    <text x="25" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">CRC32</text>
    <text x="25" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">0xC3D4</text>
    
    <rect x="52" y="10" width="70" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="87" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Timestamp</text>
    <text x="87" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">1703001005</text>
    
    <rect x="124" y="10" width="50" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="149" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">KeySz</text>
    <text x="149" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">3</text>
    
    <rect x="176" y="10" width="50" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="201" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">ValSz</text>
    <text x="201" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">3</text>
    
    <rect x="228" y="10" width="50" height="40" rx="3" fill="url(#keyGrad)" stroke="#6d28d9" stroke-width="1"/>
    <text x="253" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Key</text>
    <text x="253" y="40" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.9)">"bob"</text>
    
    <rect x="280" y="10" width="55" height="40" rx="3" fill="url(#valueGrad)" stroke="#047857" stroke-width="1"/>
    <text x="307" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Value</text>
    <text x="307" y="40" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.9)">"250"</text>
    
    <text x="350" y="35" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#6b7280">← 26 bytes</text>
  </g>
  
  <!-- Record 3: Put("alice", "150") - UPDATE -->
  <g transform="translate(40, 210)">
    <text x="0" y="-5" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#374151">Record 3: Put("alice", "150")</text>
    <text x="200" y="-5" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#f59e0b">← UPDATE (supersedes record 1)</text>
    <text x="-30" y="30" text-anchor="end" font-family="monospace" font-size="9" fill="#6b7280">54</text>
    
    <rect x="0" y="10" width="50" height="40" rx="3" fill="url(#crcGrad)" stroke="#b45309" stroke-width="1"/>
    <text x="25" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">CRC32</text>
    <text x="25" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">0xE5F6</text>
    
    <rect x="52" y="10" width="70" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="87" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Timestamp</text>
    <text x="87" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">1703001010</text>
    
    <rect x="124" y="10" width="50" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="149" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">KeySz</text>
    <text x="149" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">5</text>
    
    <rect x="176" y="10" width="50" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="201" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">ValSz</text>
    <text x="201" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">3</text>
    
    <rect x="228" y="10" width="60" height="40" rx="3" fill="url(#keyGrad)" stroke="#6d28d9" stroke-width="1"/>
    <text x="258" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Key</text>
    <text x="258" y="40" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.9)">"alice"</text>
    
    <rect x="290" y="10" width="55" height="40" rx="3" fill="url(#valueGrad)" stroke="#047857" stroke-width="1"/>
    <text x="317" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Value</text>
    <text x="317" y="40" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.9)">"150"</text>
    
    <text x="360" y="35" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#6b7280">← 28 bytes</text>
  </g>
  
  <!-- Record 4: Put("charlie", "500") -->
  <g transform="translate(40, 275)">
    <text x="0" y="-5" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#374151">Record 4: Put("charlie", "500")</text>
    <text x="-30" y="30" text-anchor="end" font-family="monospace" font-size="9" fill="#6b7280">82</text>
    
    <rect x="0" y="10" width="50" height="40" rx="3" fill="url(#crcGrad)" stroke="#b45309" stroke-width="1"/>
    <text x="25" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">CRC32</text>
    <text x="25" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">0x1A2B</text>
    
    <rect x="52" y="10" width="70" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="87" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Timestamp</text>
    <text x="87" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">1703001015</text>
    
    <rect x="124" y="10" width="50" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="149" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">KeySz</text>
    <text x="149" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">7</text>
    
    <rect x="176" y="10" width="50" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="201" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">ValSz</text>
    <text x="201" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">3</text>
    
    <rect x="228" y="10" width="75" height="40" rx="3" fill="url(#keyGrad)" stroke="#6d28d9" stroke-width="1"/>
    <text x="265" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Key</text>
    <text x="265" y="40" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.9)">"charlie"</text>
    
    <rect x="305" y="10" width="55" height="40" rx="3" fill="url(#valueGrad)" stroke="#047857" stroke-width="1"/>
    <text x="332" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Value</text>
    <text x="332" y="40" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.9)">"500"</text>
    
    <text x="375" y="35" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#6b7280">← 30 bytes</text>
  </g>
  
  <!-- Record 5: Delete("bob") - TOMBSTONE -->
  <g transform="translate(40, 340)">
    <text x="0" y="-5" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#374151">Record 5: Delete("bob")</text>
    <text x="130" y="-5" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#ef4444">← TOMBSTONE (marks deletion)</text>
    <text x="-30" y="30" text-anchor="end" font-family="monospace" font-size="9" fill="#6b7280">112</text>
    
    <rect x="0" y="10" width="50" height="40" rx="3" fill="url(#crcGrad)" stroke="#b45309" stroke-width="1"/>
    <text x="25" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">CRC32</text>
    <text x="25" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">0x3C4D</text>
    
    <rect x="52" y="10" width="70" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="87" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Timestamp</text>
    <text x="87" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">1703001020</text>
    
    <rect x="124" y="10" width="50" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="149" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">KeySz</text>
    <text x="149" y="40" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.8)">3</text>
    
    <rect x="176" y="10" width="50" height="40" rx="3" fill="url(#headerGrad)" stroke="#1e40af" stroke-width="1"/>
    <text x="201" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">ValSz</text>
    <text x="201" y="40" text-anchor="middle" font-family="monospace" font-size="8" font-weight="600" fill="#fef3c7">0</text>
    
    <rect x="228" y="10" width="50" height="40" rx="3" fill="url(#keyGrad)" stroke="#6d28d9" stroke-width="1"/>
    <text x="253" y="27" text-anchor="middle" font-family="monospace" font-size="8" fill="white">Key</text>
    <text x="253" y="40" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.9)">"bob"</text>
    
    <rect x="280" y="10" width="45" height="40" rx="3" fill="url(#tombstoneGrad)" stroke="#b91c1c" stroke-width="1"/>
    <text x="302" y="33" text-anchor="middle" font-family="monospace" font-size="8" fill="white">∅</text>
    
    <text x="340" y="35" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#6b7280">← 23 bytes (no value)</text>
  </g>
  
  <!-- End of file marker -->
  <g transform="translate(40, 405)">
    <text x="-30" y="15" text-anchor="end" font-family="monospace" font-size="9" fill="#6b7280">135</text>
    <line x1="0" y1="10" x2="350" y2="10" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="175" y="30" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#9ca3af">← next write appends here</text>
  </g>
  
  <!-- Summary box -->
  <rect x="500" y="85" width="350" height="305" rx="8" fill="#f0fdf4" stroke="#10b981" stroke-width="1.5"/>
  <text x="675" y="110" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="13" font-weight="600" fill="#065f46">Hash Index State</text>
  <text x="675" y="128" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#6b7280">(in-memory after these 5 operations)</text>
  
  <text x="520" y="160" font-family="monospace" font-size="11" fill="#374151">hashMap = {</text>
  <text x="540" y="185" font-family="monospace" font-size="11" fill="#374151">"alice":   {offset: 54,  size: 28}</text>
  <text x="540" y="210" font-family="monospace" font-size="11" fill="#374151">"charlie": {offset: 82,  size: 30}</text>
  <text x="540" y="235" font-family="monospace" font-size="11" fill="#6b7280">// "bob" returns ErrKeyNotFound</text>
  <text x="520" y="260" font-family="monospace" font-size="11" fill="#374151">}</text>
  
  <line x1="520" y1="280" x2="830" y2="280" stroke="#d1d5db" stroke-width="1"/>
  
  <text x="520" y="305" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="#374151">• Record 1 (alice:100) is <tspan fill="#f59e0b">stale</tspan></text>
  <text x="520" y="325" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="#374151">• Record 2 (bob:250) is <tspan fill="#f59e0b">stale</tspan></text>
  <text x="520" y="345" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="#374151">• Record 3 is latest for "alice"</text>
  <text x="520" y="365" font-family="system-ui, -apple-system, sans-serif" font-size="11" fill="#374151">• Record 5 is tombstone for "bob"</text>
  
  <!-- Legend -->
  <g transform="translate(30, 475)">
    <rect x="0" y="0" width="16" height="16" rx="2" fill="url(#crcGrad)"/>
    <text x="22" y="12" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#374151">CRC32</text>
    
    <rect x="80" y="0" width="16" height="16" rx="2" fill="url(#headerGrad)"/>
    <text x="102" y="12" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#374151">Header fields</text>
    
    <rect x="190" y="0" width="16" height="16" rx="2" fill="url(#keyGrad)"/>
    <text x="212" y="12" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#374151">Key</text>
    
    <rect x="260" y="0" width="16" height="16" rx="2" fill="url(#valueGrad)"/>
    <text x="282" y="12" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#374151">Value</text>
    
    <rect x="340" y="0" width="16" height="16" rx="2" fill="url(#tombstoneGrad)"/>
    <text x="362" y="12" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#374151">Tombstone (empty value)</text>
  </g>
</svg>
